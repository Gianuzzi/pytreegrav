<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pytreegrav package &mdash; pytreegrav 1.2.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=ca842793"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pytreegrav
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Nbody_simulation.html">Example: N-body simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend_API.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Feedback, Support, and Contributions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pytreegrav</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pytreegrav package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pytreegrav.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pytreegrav-package">
<h1>pytreegrav package<a class="headerlink" href="#pytreegrav-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pytreegrav.bruteforce">
<span id="pytreegrav-bruteforce-module"></span><h2>pytreegrav.bruteforce module<a class="headerlink" href="#module-pytreegrav.bruteforce" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.AccelTarget_bruteforce">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">AccelTarget_bruteforce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.AccelTarget_bruteforce" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational acceleration at a set of target positions, due to a set of source particles.</p>
<p>Arguments:
x_target – shape (N,3) array of positions where the field is to be evaluated
softening_target – shape (N,) array of minimum softening lengths to be used
x_source – shape (M,3) array of positions of gravitating particles
m_source – shape (M,) array of particle masses
softening_source – shape (M,) array of softening lengths</p>
<p>Optional arguments:
G – gravitational constant (default 1.0)</p>
<p>Returns:
shape (N,3) array of gravitational accelerations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.AccelTarget_bruteforce_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">AccelTarget_bruteforce_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.AccelTarget_bruteforce_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational acceleration at a set of target positions, due to a set of source particles.</p>
<p>Arguments:
x_target – shape (N,3) array of positions where the field is to be evaluated
softening_target – shape (N,) array of minimum softening lengths to be used
x_source – shape (M,3) array of positions of gravitating particles
m_source – shape (M,) array of particle masses
softening_source – shape (M,) array of softening lengths</p>
<p>Optional arguments:
G – gravitational constant (default 1.0)</p>
<p>Returns:
shape (N,3) array of gravitational accelerations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.Accel_bruteforce">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">Accel_bruteforce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.Accel_bruteforce" title="Link to this definition"></a></dt>
<dd><p>Returns the exact mutually-interacting gravitational accelerations of a set of particles.</p>
<p>Arguments:
x – shape (N,3) array of positions where the potential is to be evaluated
m – shape (N,) array of particle masses
softening – shape (N,) array of softening lengths</p>
<p>Optional arguments:
G – gravitational constant (default 1.0)</p>
<p>Returns:
shape (N,3) array of gravitational accelerations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.Accel_bruteforce_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">Accel_bruteforce_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.Accel_bruteforce_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the exact mutually-interacting gravitational accelerations of a set of particles.</p>
<p>Arguments:
x – shape (N,3) array of positions where the potential is to be evaluated
m – shape (N,) array of particle masses
softening – shape (N,) array of softening lengths</p>
<p>Optional arguments:
G – gravitational constant (default 1.0)</p>
<p>Returns:
shape (N,3) array of gravitational accelerations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.PotentialTarget_bruteforce">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">PotentialTarget_bruteforce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.PotentialTarget_bruteforce" title="Link to this definition"></a></dt>
<dd><p>Returns the exact gravitational potential due to a set of particles, at a set of positions that need not be the same as the particle positions.</p>
<p>Arguments:
x_target – shape (N,3) array of positions where the potential is to be evaluated
softening_target – shape (N,) array of minimum softening lengths to be used
x_source – shape (M,3) array of positions of gravitating particles
m_source – shape (M,) array of particle masses
softening_source – shape (M,) array of softening lengths</p>
<p>Optional arguments:
G – gravitational constant (default 0.7)</p>
<p>Returns:
shape (N,) array of potential values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.PotentialTarget_bruteforce_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">PotentialTarget_bruteforce_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.PotentialTarget_bruteforce_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the exact gravitational potential due to a set of particles, at a set of positions that need not be the same as the particle positions.</p>
<p>Arguments:
x_target – shape (N,3) array of positions where the potential is to be evaluated
softening_target – shape (N,) array of minimum softening lengths to be used
x_source – shape (M,3) array of positions of gravitating particles
m_source – shape (M,) array of particle masses
softening_source – shape (M,) array of softening lengths</p>
<p>Optional arguments:
G – gravitational constant (default 0.7)</p>
<p>Returns:
shape (N,) array of potential values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.Potential_bruteforce">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">Potential_bruteforce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.Potential_bruteforce" title="Link to this definition"></a></dt>
<dd><p>Returns the exact mutually-interacting gravitational potential for a set of particles with positions x and masses m, evaluated by brute force.</p>
<p>Arguments:
x – shape (N,3) array of particle positions
m – shape (N,) array of particle masses
softening – shape (N,) array containing kernel support radii for gravitational softening</p>
<p>Optional arguments:
G – gravitational constant (default 1.0)</p>
<p>Returns:
shape (N,) array containing potential values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.bruteforce.Potential_bruteforce_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.bruteforce.</span></span><span class="sig-name descname"><span class="pre">Potential_bruteforce_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.bruteforce.Potential_bruteforce_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the exact mutually-interacting gravitational potential for a set of particles with positions x and masses m, evaluated by brute force.</p>
<p>Arguments:
x – shape (N,3) array of particle positions
m – shape (N,) array of particle masses
softening – shape (N,) array containing kernel support radii for gravitational softening</p>
<p>Optional arguments:
G – gravitational constant (default 1.0)</p>
<p>Returns:
shape (N,) array containing potential values</p>
</dd></dl>

</section>
<section id="module-pytreegrav.dynamic_tree">
<span id="pytreegrav-dynamic-tree-module"></span><h2>pytreegrav.dynamic_tree module<a class="headerlink" href="#module-pytreegrav.dynamic_tree" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.dynamic_tree.ComputeMomentsDynamic">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.dynamic_tree.</span></span><span class="sig-name descname"><span class="pre">ComputeMomentsDynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">children</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.dynamic_tree.ComputeMomentsDynamic" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytreegrav.dynamic_tree.DynamicOctree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytreegrav.dynamic_tree.</span></span><span class="sig-name descname"><span class="pre">DynamicOctree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.dynamic_tree.DynamicOctree" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytreegrav.dynamic_tree.DynamicOctree" title="pytreegrav.dynamic_tree.DynamicOctree"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicOctree</span></code></a></p>
<p>Octree implementation that stores node velocities for correlation functions and dynamic updates.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytreegrav.dynamic_tree.DynamicOctree.class_type">
<span class="sig-name descname"><span class="pre">class_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">jitclass.DynamicOctree#76beab8bbac0&lt;Sizes:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),Deltas:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),Coordinates:array(float64,</span> <span class="pre">2d,</span> <span class="pre">A),Velocities:array(float64,</span> <span class="pre">2d,</span> <span class="pre">A),VelocityDisp:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),Masses:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),Quadrupoles:array(float64,</span> <span class="pre">3d,</span> <span class="pre">A),HasQuads:bool,NumParticles:int64,NumNodes:int64,Softenings:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),NextBranch:array(int64,</span> <span class="pre">1d,</span> <span class="pre">A),FirstSubnode:array(int64,</span> <span class="pre">1d,</span> <span class="pre">A),TreewalkIndices:array(int64,</span> <span class="pre">1d,</span> <span class="pre">A)&gt;</span></em><a class="headerlink" href="#pytreegrav.dynamic_tree.DynamicOctree.class_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.dynamic_tree.SetupTreewalk">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.dynamic_tree.</span></span><span class="sig-name descname"><span class="pre">SetupTreewalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">children</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.dynamic_tree.SetupTreewalk" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytreegrav.frontend">
<span id="pytreegrav-frontend-module"></span><h2>pytreegrav.frontend module<a class="headerlink" href="#module-pytreegrav.frontend" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.Accel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">Accel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adaptive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.Accel" title="Link to this definition"></a></dt>
<dd><p>Gravitational acceleration calculation</p>
<p>Returns the gravitational acceleration for a set of particles with positions x and masses m, at the positions of those particles, using either brute force or tree-based methods depending on the number of particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array_like</em>) – shape (N,3) array of particle positions</p></li>
<li><p><strong>m</strong> (<em>array_like</em>) – shape (N,) array of particle masses</p></li>
<li><p><strong>G</strong> (<em>float</em><em>, </em><em>optional</em>) – gravitational constant (default 1.0)</p></li>
<li><p><strong>softening</strong> (<em>None</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – shape (N,) array containing kernel support radii for gravitational softening - these give the radius of compact support of the M4 cubic spline mass distribution - set to 0 by default</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7, gives ~1% accuracy)</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the force summation over all available cores. (default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles, not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – return the tree used for future use (default False)</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Which summation method to use: ‘adaptive’, ‘tree’, or ‘bruteforce’ (default adaptive tries to pick the faster choice)</p></li>
<li><p><strong>quadrupole</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use quadrupole moments in tree summation (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g</strong> – shape (N,3) array of acceleration vectors at the particle positions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.AccelTarget">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">AccelTarget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adaptive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.AccelTarget" title="Link to this definition"></a></dt>
<dd><p>Gravitational acceleration calculation for general N+M body case</p>
<p>Returns the gravitational acceleration for a set of M particles with positions x_source and masses m_source, at the positions of a set of N particles that need not be the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_target</strong> (<em>array_like</em>) – shape (N,3) array of target particle positions where you want to know the acceleration</p></li>
<li><p><strong>pos_source</strong> (<em>array_like</em>) – shape (M,3) array of source particle positions (positions of particles sourcing the gravitational field)</p></li>
<li><p><strong>m_source</strong> (<em>array_like</em>) – shape (M,) array of source particle masses</p></li>
<li><p><strong>softening_target</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – shape (N,) array of target particle softening radii - these give the radius of compact support of the M4 cubic spline mass distribution</p></li>
<li><p><strong>softening_source</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – shape (M,) array of source particle radii - these give the radius of compact support of the M4 cubic spline mass distribution</p></li>
<li><p><strong>G</strong> (<em>float</em><em>, </em><em>optional</em>) – gravitational constant (default 1.0)</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7, gives ~1% accuracy)</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the force summation over all available cores. (default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles, not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – return the tree used for future use (default False)</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Which summation method to use: ‘adaptive’, ‘tree’, or ‘bruteforce’ (default adaptive tries to pick the faster choice)</p></li>
<li><p><strong>quadrupole</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use quadrupole moments in tree summation (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>phi</strong> – shape (N,3) array of accelerations at the target positions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.ColumnDensity">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">ColumnDensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">healpix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.ColumnDensity" title="Link to this definition"></a></dt>
<dd><p>Ray-traced or angle-binned column density calculation.</p>
<p>Returns an estimate of the column density from the position of each particle
integrated to infinity, assuming the particles are represented by uniform spheres. Note
that optical depth can be obtained by supplying “sigma = opacity * mass” in
place of mass, useful in situations where opacity is highly variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array_like</em>) – shape (N,3) array of particle positions</p></li>
<li><p><strong>m</strong> (<em>array_like</em>) – shape (N,) array of particle masses</p></li>
<li><p><strong>radii</strong> (<em>array_like</em>) – shape (N,) array containing particle radii of the uniform spheres that
we use to model the particles’ mass distribution</p></li>
<li><p><strong>rays</strong> (<em>optional</em>) – Which ray directions to raytrace the columns.
None: use the angular-binned column density method with 6 bins on the sky
OPTION 2: Integer number: use this many rays, with 6 using the standard
6-ray grid and other numbers sampling random directions
OPTION 3: Give a (N_rays,3) array of vectors specifying the
directions, which will be automatically normalized.</p></li>
<li><p><strong>healpix</strong> (<em>int</em><em>, </em><em>optional</em>) – Use healpix ray grid with specified resolution level NSIDE</p></li>
<li><p><strong>randomize_rays</strong> (<em>bool</em><em>, </em><em>optional</em>) – Randomize the orientation of the ray-grid <em>for each particle</em></p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the column density over all available cores.
(default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles,
not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – Opening angle for beam-traced angular bin estimator</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – return the tree used for future use (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>columns</strong> – shape (N,N_rays) float array of column densities from particle
centers integrated along the rays</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.ConstructTree">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">ConstructTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_moments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morton_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.ConstructTree" title="Link to this definition"></a></dt>
<dd><p>Builds a tree containing particle data, for subsequent potential/field evaluation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array_like</em>) – shape (N,3) array of particle positions</p></li>
<li><p><strong>m</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – shape (N,) array of particle masses - if None then zeros will be used (e.g. if all you need the tree for is spatial algorithms)</p></li>
<li><p><strong>softening</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – shape (N,) array of particle softening lengths - these give the radius of compact support of the M4 cubic spline mass distribution of each particle</p></li>
<li><p><strong>quadrupole</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to store quadrupole moments (default False)</p></li>
<li><p><strong>vel</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to store node velocities in the tree (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tree</strong> – Octree instance built from particle data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>octree</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.DensityCorrFunc">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">DensityCorrFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.DensityCorrFunc" title="Link to this definition"></a></dt>
<dd><p>Computes the average amount of mass in radial bin [r,r+dr] around a point, provided a set of radial bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array_like</em>) – shape (N,3) array of particle positions</p></li>
<li><p><strong>m</strong> (<em>array_like</em>) – shape (N,) array of particle masses</p></li>
<li><p><strong>rbins</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – 1D array of radial bin edges - if None will use heuristics to determine sensible bins. Otherwise MUST BE LOGARITHMICALLY SPACED (default None)</p></li>
<li><p><strong>max_bin_size_ratio</strong> (<em>float</em><em>, </em><em>optional</em>) – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width (default 100)</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – cell opening angle used to control accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 1.0)</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the correlation function computation over all available cores. (default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles, not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True will return the generated or used tree for future use (default False)</p></li>
<li><p><strong>boxsize</strong> (<em>float</em><em>, </em><em>optional</em>) – finite periodic box size, if periodic boundary conditions are to be used (default 0)</p></li>
<li><p><strong>weighted_binning</strong> (<em>bool</em><em>, </em><em>optional</em>) – (experimental) if True will distribute mass among radial bings with a weighted kernel (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rbins</strong> (<em>array_like</em>) – array containing radial bin edges</p></li>
<li><p><strong>mbins</strong> (<em>array_like</em>) – array containing mean mass in radial bins, averaged over all points</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.Potential">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">Potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adaptive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.Potential" title="Link to this definition"></a></dt>
<dd><p>Gravitational potential calculation</p>
<p>Returns the gravitational potential for a set of particles with positions x and masses m, at the positions of those particles, using either brute force or tree-based methods depending on the number of particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array_like</em>) – shape (N,3) array of particle positions</p></li>
<li><p><strong>m</strong> (<em>array_like</em>) – shape (N,) array of particle masses</p></li>
<li><p><strong>G</strong> (<em>float</em><em>, </em><em>optional</em>) – gravitational constant (default 1.0)</p></li>
<li><p><strong>softening</strong> (<em>None</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – shape (N,) array containing kernel support radii for gravitational softening -  - these give the radius of compact support of the M4 cubic spline mass distribution - set to 0 by default</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7, gives ~1% accuracy)</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the force summation over all available cores. (default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles, not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – return the tree used for future use (default False)</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Which summation method to use: ‘adaptive’, ‘tree’, or ‘bruteforce’ (default adaptive tries to pick the faster choice)</p></li>
<li><p><strong>quadrupole</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use quadrupole moments in tree summation (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>phi</strong> – shape (N,) array of potentials at the particle positions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.PotentialTarget">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">PotentialTarget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adaptive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.PotentialTarget" title="Link to this definition"></a></dt>
<dd><p>Gravitational potential calculation for general N+M body case</p>
<p>Returns the gravitational potential for a set of M particles with positions x_source and masses m_source, at the positions of a set of N particles that need not be the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_target</strong> (<em>array_like</em>) – shape (N,3) array of target particle positions where you want to know the potential</p></li>
<li><p><strong>pos_source</strong> (<em>array_like</em>) – shape (M,3) array of source particle positions (positions of particles sourcing the gravitational field)</p></li>
<li><p><strong>m_source</strong> (<em>array_like</em>) – shape (M,) array of source particle masses</p></li>
<li><p><strong>softening_target</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – shape (N,) array of target particle softening radii - these give the radius of compact support of the M4 cubic spline mass distribution</p></li>
<li><p><strong>softening_source</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – shape (M,) array of source particle radii  - these give the radius of compact support of the M4 cubic spline mass distribution</p></li>
<li><p><strong>G</strong> (<em>float</em><em>, </em><em>optional</em>) – gravitational constant (default 1.0)</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7, gives ~1% accuracy)</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the force summation over all available cores. (default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles, not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – return the tree used for future use (default False)</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Which summation method to use: ‘adaptive’, ‘tree’, or ‘bruteforce’ (default adaptive tries to pick the faster choice)</p></li>
<li><p><strong>quadrupole</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use quadrupole moments in tree summation (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>phi</strong> – shape (N,) array of potentials at the target positions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.VelocityCorrFunc">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">VelocityCorrFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.VelocityCorrFunc" title="Link to this definition"></a></dt>
<dd><p>Computes the weighted average product v(x).v(x+r), for a vector field v, in radial bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array_like</em>) – shape (N,3) array of particle positions</p></li>
<li><p><strong>m</strong> (<em>array_like</em>) – shape (N,) array of particle masses</p></li>
<li><p><strong>v</strong> (<em>array_like</em>) – shape (N,3) of vector quantity (e.g. velocity, magnetic field, etc)</p></li>
<li><p><strong>rbins</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – 1D array of radial bin edges - if None will use heuristics to determine sensible bins. Otherwise MUST BE LOGARITHMICALLY SPACED (default None)</p></li>
<li><p><strong>max_bin_size_ratio</strong> (<em>float</em><em>, </em><em>optional</em>) – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width (default 100)</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – cell opening angle used to control accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 1.0)</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the correlation function computation over all available cores. (default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles, not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True will return the generated or used tree for future use (default False)</p></li>
<li><p><strong>boxsize</strong> (<em>float</em><em>, </em><em>optional</em>) – finite periodic box size, if periodic boundary conditions are to be used (default 0)</p></li>
<li><p><strong>weighted_binning</strong> (<em>bool</em><em>, </em><em>optional</em>) – (experimental) if True will distribute mass among radial bings with a weighted kernel (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rbins</strong> (<em>array_like</em>) – array containing radial bin edges</p></li>
<li><p><strong>corr</strong> (<em>array_like</em>) – array containing correlation function values in radial bins</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.VelocityStructFunc">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">VelocityStructFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.VelocityStructFunc" title="Link to this definition"></a></dt>
<dd><p>Computes the structure function for a vector field: the average value of <a href="#id1"><span class="problematic" id="id2">|</span></a>v(x)-v(x+r)|^2, in radial bins for r</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>array_like</em>) – shape (N,3) array of particle positions</p></li>
<li><p><strong>m</strong> (<em>array_like</em>) – shape (N,) array of particle masses</p></li>
<li><p><strong>v</strong> (<em>array_like</em>) – shape (N,3) of vector quantity (e.g. velocity, magnetic field, etc)</p></li>
<li><p><strong>rbins</strong> (<em>array_like</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – 1D array of radial bin edges - if None will use heuristics to determine sensible bins. Otherwise MUST BE LOGARITHMICALLY SPACED (default None)</p></li>
<li><p><strong>max_bin_size_ratio</strong> (<em>float</em><em>, </em><em>optional</em>) – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width (default 100)</p></li>
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>optional</em>) – cell opening angle used to control accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 1.0)</p></li>
<li><p><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will parallelize the correlation function computation over all available cores. (default False)</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a><em>, </em><em>optional</em>) – optional pre-generated Octree: this can contain any set of particles, not necessarily the target particles at pos (default None)</p></li>
<li><p><strong>return_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True will return the generated or used tree for future use (default False)</p></li>
<li><p><strong>boxsize</strong> (<em>float</em><em>, </em><em>optional</em>) – finite periodic box size, if periodic boundary conditions are to be used (default 0)</p></li>
<li><p><strong>weighted_binning</strong> (<em>bool</em><em>, </em><em>optional</em>) – (experimental) if True will distribute mass among radial bings with a weighted kernel (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rbins</strong> (<em>array_like</em>) – array containing radial bin edges</p></li>
<li><p><strong>Sv</strong> (<em>array_like</em>) – array containing structure function values</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.frontend.valueTestMethod">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.frontend.</span></span><span class="sig-name descname"><span class="pre">valueTestMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.frontend.valueTestMethod" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytreegrav.kernel">
<span id="pytreegrav-kernel-module"></span><h2>pytreegrav.kernel module<a class="headerlink" href="#module-pytreegrav.kernel" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.kernel.ForceKernel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.kernel.</span></span><span class="sig-name descname"><span class="pre">ForceKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.kernel.ForceKernel" title="Link to this definition"></a></dt>
<dd><p>Returns the quantity equivalent to (fraction of mass enclosed)/ r^3 for a cubic-spline mass distribution of compact support radius h. Used to calculate the softened gravitational force.</p>
<p>Arguments:
r - radius
h - softening</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.kernel.PotentialKernel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.kernel.</span></span><span class="sig-name descname"><span class="pre">PotentialKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.kernel.PotentialKernel" title="Link to this definition"></a></dt>
<dd><p>Returns the equivalent of -1/r for a cubic-spline mass distribution of compact support radius h. Used to calculate the softened gravitational potential.</p>
<p>Arguments:
r - radius
h - softening</p>
</dd></dl>

</section>
<section id="module-pytreegrav.octree">
<span id="pytreegrav-octree-module"></span><h2>pytreegrav.octree module<a class="headerlink" href="#module-pytreegrav.octree" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.octree.ComputeMoments">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.octree.</span></span><span class="sig-name descname"><span class="pre">ComputeMoments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">children</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.octree.ComputeMoments" title="Link to this definition"></a></dt>
<dd><p>Does a recursive pass through the tree and computes centers of mass, total mass, max softening, and distance between geometric center and COM</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytreegrav.octree.Octree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytreegrav.octree.</span></span><span class="sig-name descname"><span class="pre">Octree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.octree.Octree" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Octree</span></code></a></p>
<p>Octree implementation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytreegrav.octree.Octree.class_type">
<span class="sig-name descname"><span class="pre">class_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">jitclass.Octree#76becaee2160&lt;Sizes:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),Deltas:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),Coordinates:array(float64,</span> <span class="pre">2d,</span> <span class="pre">A),Masses:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),Quadrupoles:array(float64,</span> <span class="pre">3d,</span> <span class="pre">A),HasQuads:bool,NumParticles:int64,NumNodes:int64,Softenings:array(float64,</span> <span class="pre">1d,</span> <span class="pre">A),NextBranch:array(int64,</span> <span class="pre">1d,</span> <span class="pre">A),FirstSubnode:array(int64,</span> <span class="pre">1d,</span> <span class="pre">A),TreewalkIndices:array(int64,</span> <span class="pre">1d,</span> <span class="pre">A)&gt;</span></em><a class="headerlink" href="#pytreegrav.octree.Octree.class_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.octree.SetupTreewalk">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.octree.</span></span><span class="sig-name descname"><span class="pre">SetupTreewalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">children</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.octree.SetupTreewalk" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.octree.increase_tree_size">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.octree.</span></span><span class="sig-name descname"><span class="pre">increase_tree_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.octree.increase_tree_size" title="Link to this definition"></a></dt>
<dd><p>Reallocate the tree data with storage increased by factor fac</p>
</dd></dl>

</section>
<section id="module-pytreegrav.treewalk">
<span id="pytreegrav-treewalk-module"></span><h2>pytreegrav.treewalk module<a class="headerlink" href="#module-pytreegrav.treewalk" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.AccelTarget_tree">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">AccelTarget_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.AccelTarget_tree" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational acceleration at the specified points, given a tree containing the mass distribution
Arguments:
pos_target – shape (N,3) array of positions at which to evaluate the field
softening_target – shape (N,) array of <em>minimum</em> softening lengths to be used in all accel computations
tree – Octree instance containing the positions, masses, and softenings of the source particles
Optional arguments:
G – gravitational constant (default 1.0)
theta – accuracy parameter, smaller is more accurate, larger is faster (default 0.7)
Returns:
shape (N,3) array of acceleration values at each point in pos_target</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.AccelTarget_tree_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">AccelTarget_tree_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.AccelTarget_tree_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational acceleration at the specified points, given a tree containing the mass distribution
Arguments:
pos_target – shape (N,3) array of positions at which to evaluate the field
softening_target – shape (N,) array of <em>minimum</em> softening lengths to be used in all accel computations
tree – Octree instance containing the positions, masses, and softenings of the source particles
Optional arguments:
G – gravitational constant (default 1.0)
theta – accuracy parameter, smaller is more accurate, larger is faster (default 0.7)
Returns:
shape (N,3) array of acceleration values at each point in pos_target</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.AccelWalk">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">AccelWalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.AccelWalk" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational acceleration field at position x by performing the Barnes-Hut treewalk using the provided octree instance
Arguments:
pos - (3,) array containing position of interest
tree - octree instance storing the tree structure
Keyword arguments:
softening - softening radius of the particle at which the force is being evaluated - we use the greater of the target and source softenings when evaluating the softened potential
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization
theta - cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7 gives ~1% accuracy)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.AccelWalk_quad">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">AccelWalk_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.AccelWalk_quad" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational acceleration field at position x by performing the Barnes-Hut treewalk using the provided octree instance. Uses the quadrupole expansion.
Arguments:
pos - (3,) array containing position of interest
tree - octree instance storing the tree structure
Keyword arguments:
softening - softening radius of the particle at which the force is being evaluated - we use the greater of the target and source softenings when evaluating the softened potential
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization
theta - cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7 gives ~1% accuracy)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.ColumnDensityWalk_binned">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">ColumnDensityWalk_binned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.ColumnDensityWalk_binned" title="Link to this definition"></a></dt>
<dd><p>Returns the integrated column density to infinity from pos, in the directions given by the rays argument</p>
<p>Arguments:
pos - (3,) array containing position of interest
tree - octree object storing the tree structure</p>
<p>Returns:
columns - shape (6,) array of average column densities in the 6 equal bins on the sphere</p>
<p>Keyword arguments:
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.ColumnDensityWalk_multiray">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">ColumnDensityWalk_multiray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.ColumnDensityWalk_multiray" title="Link to this definition"></a></dt>
<dd><p>Returns the integrated column density to infinity from pos, in the directions given by the rays argument</p>
<p>Arguments:
pos - (3,) array containing position of interest
rays - (N_rays, 3) array of unit vectors
tree - octree object storing the tree structure</p>
<p>Returns:
columns - (N_rays,) array of column densities along directions given by rays</p>
<p>Keyword arguments:
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.ColumnDensityWalk_singleray">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">ColumnDensityWalk_singleray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.ColumnDensityWalk_singleray" title="Link to this definition"></a></dt>
<dd><p>Returns the integrated column density to infinity from pos, in the directions given by the rays argument</p>
<p>Arguments:
pos - (3,) array containing position of interest
ray - (3,) array with the unit vector of the ray
tree - octree object storing the tree structure</p>
<p>Returns:
columns - (N_rays,) array of column densities along directions given by rays</p>
<p>Keyword arguments:
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.ColumnDensity_tree">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">ColumnDensity_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.ColumnDensity_tree" title="Link to this definition"></a></dt>
<dd><p>Returns the column density integrated to infinity from pos_target along rays, given the mass distribution in an Octree</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_target</strong> (<em>array_like</em>) – shape (N,3) array of target particle positions where you want to know the potential.</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a>) – Octree instance initialized with the positions, masses, and softenings of the source particles.</p></li>
<li><p><strong>rays</strong> (<em>array_like</em>) – Shape (N_rays,3) array of ray direction unit vectors. If None then we instead compute average column densities in a 6-bin tesselation of the sphere.</p></li>
<li><p><strong>randomize_rays</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>particle.</strong> (<em>Randomly orients the raygrid for each</em>) – </p></li>
<li><p><strong>particle.</strong> – Randomly orients the raygrid for each particle.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.ColumnDensity_tree_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">ColumnDensity_tree_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.ColumnDensity_tree_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the column density integrated to infinity from pos_target along rays, given the mass distribution in an Octree</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_target</strong> (<em>array_like</em>) – shape (N,3) array of target particle positions where you want to know the potential.</p></li>
<li><p><strong>tree</strong> (<a class="reference internal" href="#pytreegrav.octree.Octree" title="pytreegrav.octree.Octree"><em>Octree</em></a>) – Octree instance initialized with the positions, masses, and softenings of the source particles.</p></li>
<li><p><strong>rays</strong> (<em>array_like</em>) – Shape (N_rays,3) array of ray direction unit vectors. If None then we instead compute average column densities in a 6-bin tesselation of the sphere.</p></li>
<li><p><strong>randomize_rays</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>particle.</strong> (<em>Randomly orients the raygrid for each</em>) – </p></li>
<li><p><strong>particle.</strong> – Randomly orients the raygrid for each particle.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.DensityCorrFunc_tree">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">DensityCorrFunc_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.DensityCorrFunc_tree" title="Link to this definition"></a></dt>
<dd><p>Returns the average mass in radial bins surrounding a point</p>
<p>Arguments:
pos – shape (N,3) array of particle positions
tree – Octree instance containing the positions, masses, and softenings of the source particles</p>
<p>Optional arguments:
rbins – 1D array of radial bin edges - if None will use heuristics to determine sensible bins
max_bin_size_ratio – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width</p>
<p>Returns:
mbins – arrays containing total mass in each bin</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.DensityCorrFunc_tree_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">DensityCorrFunc_tree_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.DensityCorrFunc_tree_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the average mass in radial bins surrounding a point</p>
<p>Arguments:
pos – shape (N,3) array of particle positions
tree – Octree instance containing the positions, masses, and softenings of the source particles</p>
<p>Optional arguments:
rbins – 1D array of radial bin edges - if None will use heuristics to determine sensible bins
max_bin_size_ratio – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width</p>
<p>Returns:
mbins – arrays containing total mass in each bin</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.DensityCorrWalk">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">DensityCorrWalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.DensityCorrWalk" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational potential at position x by performing the Barnes-Hut treewalk using the provided octree instance</p>
<p>Arguments:
pos - (3,) array containing position of interest
tree - octree object storing the tree structure</p>
<p>Keyword arguments:
softening - softening radius of the particle at which the force is being evaluated - we use the greater of the target and source softenings when evaluating the softened potential
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization
theta - cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7 gives ~1% accuracy)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.NearestImage">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">NearestImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.NearestImage" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.PotentialTarget_tree">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">PotentialTarget_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.PotentialTarget_tree" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational potential at the specified points, given a tree containing the mass distribution
Arguments:
pos_target – shape (N,3) array of positions at which to evaluate the potential
softening_target – shape (N,) array of <em>minimum</em> softening lengths to be used in all potential computations
tree – Octree instance containing the positions, masses, and softenings of the source particles
Optional arguments:
G – gravitational constant (default 1.0)
theta – accuracy parameter, smaller is more accurate, larger is faster (default 0.7)
Returns:
shape (N,) array of potential values at each point in pos</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.PotentialTarget_tree_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">PotentialTarget_tree_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.PotentialTarget_tree_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational potential at the specified points, given a tree containing the mass distribution
Arguments:
pos_target – shape (N,3) array of positions at which to evaluate the potential
softening_target – shape (N,) array of <em>minimum</em> softening lengths to be used in all potential computations
tree – Octree instance containing the positions, masses, and softenings of the source particles
Optional arguments:
G – gravitational constant (default 1.0)
theta – accuracy parameter, smaller is more accurate, larger is faster (default 0.7)
Returns:
shape (N,) array of potential values at each point in pos</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.PotentialWalk">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">PotentialWalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.PotentialWalk" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational potential at position x by performing the Barnes-Hut treewalk using the provided octree instance
Arguments:
pos - (3,) array containing position of interest
tree - octree object storing the tree structure
Keyword arguments:
softening - softening radius of the particle at which the force is being evaluated - we use the greater of the target and source softenings when evaluating the softened potential
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization
theta - cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7 gives ~1% accuracy)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.PotentialWalk_quad">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">PotentialWalk_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.PotentialWalk_quad" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational potential at position x by performing the Barnes-Hut treewalk using the provided octree instance. Uses the quadrupole expansion.
Arguments:
pos - (3,) array containing position of interest
tree - octree object storing the tree structure
Keyword arguments:
softening - softening radius of the particle at which the force is being evaluated - we use the greater of the target and source softenings when evaluating the softened potential
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization
theta - cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7 gives ~1% accuracy)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.VelocityCorrFunc_tree">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">VelocityCorrFunc_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.VelocityCorrFunc_tree" title="Link to this definition"></a></dt>
<dd><p>Returns the average mass in radial bins surrounding a point</p>
<p>Arguments:
pos – shape (N,3) array of particle positions
tree – Octree instance containing the positions, masses, and softenings of the source particles</p>
<p>Optional arguments:
rbins – 1D array of radial bin edges - if None will use heuristics to determine sensible bins
max_bin_size_ratio – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width (default 0.5)</p>
<p>Returns:
mbins – arrays containing total mass in each bin</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.VelocityCorrFunc_tree_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">VelocityCorrFunc_tree_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.VelocityCorrFunc_tree_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the average mass in radial bins surrounding a point</p>
<p>Arguments:
pos – shape (N,3) array of particle positions
tree – Octree instance containing the positions, masses, and softenings of the source particles</p>
<p>Optional arguments:
rbins – 1D array of radial bin edges - if None will use heuristics to determine sensible bins
max_bin_size_ratio – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width (default 0.5)</p>
<p>Returns:
mbins – arrays containing total mass in each bin</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.VelocityCorrWalk">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">VelocityCorrWalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.VelocityCorrWalk" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational potential at position x by performing the Barnes-Hut treewalk using the provided octree instance</p>
<p>Arguments:
pos - (3,) array containing position of interest
vel - (3,) array containing velocity of point of interest
tree - octree object storing the tree structure</p>
<p>Keyword arguments:
softening - softening radius of the particle at which the force is being evaluated - we use the greater of the target and source softenings when evaluating the softened potential
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization
theta - cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7 gives ~1% accuracy)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.VelocityStructFunc_tree">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">VelocityStructFunc_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.VelocityStructFunc_tree" title="Link to this definition"></a></dt>
<dd><p>Returns the average mass in radial bins surrounding a point</p>
<p>Arguments:
pos – shape (N,3) array of particle positions
tree – Octree instance containing the positions, masses, and softenings of the source particles</p>
<p>Optional arguments:
rbins – 1D array of radial bin edges - if None will use heuristics to determine sensible bins
max_bin_size_ratio – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width (default 0.5)</p>
<p>Returns:
mbins – arrays containing total mass in each bin</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.VelocityStructFunc_tree_parallel">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">VelocityStructFunc_tree_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.VelocityStructFunc_tree_parallel" title="Link to this definition"></a></dt>
<dd><p>Returns the average mass in radial bins surrounding a point</p>
<p>Arguments:
pos – shape (N,3) array of particle positions
tree – Octree instance containing the positions, masses, and softenings of the source particles</p>
<p>Optional arguments:
rbins – 1D array of radial bin edges - if None will use heuristics to determine sensible bins
max_bin_size_ratio – controls the accuracy of the binning - tree nodes are subdivided until their side length is at most this factor * the radial bin width (default 0.5)</p>
<p>Returns:
mbins – arrays containing total mass in each bin</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.VelocityStructWalk">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">VelocityStructWalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin_size_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.VelocityStructWalk" title="Link to this definition"></a></dt>
<dd><p>Returns the gravitational potential at position x by performing the Barnes-Hut treewalk using the provided octree instance</p>
<p>Arguments:
pos - (3,) array containing position of interest
vel - (3,) array containing velocity of point of interest
tree - octree object storing the tree structure</p>
<p>Keyword arguments:
softening - softening radius of the particle at which the force is being evaluated - we use the greater of the target and source softenings when evaluating the softened potential
no - index of the top-level node whose field is being summed - defaults to the global top-level node, can use a subnode in principle for e.g. parallelization
theta - cell opening angle used to control force accuracy; smaller is slower (runtime ~ theta^-3) but more accurate. (default 0.7 gives ~1% accuracy)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.acceptance_criterion">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">acceptance_criterion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#pytreegrav.treewalk.acceptance_criterion" title="Link to this definition"></a></dt>
<dd><p>Criterion for accepting the multipole approximation for summing the contribution of a node</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.angular_bin">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">angular_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.angular_bin" title="Link to this definition"></a></dt>
<dd><p>Angular bin for binned column density estimator</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytreegrav.treewalk.do_weighted_binning">
<span class="sig-prename descclassname"><span class="pre">pytreegrav.treewalk.</span></span><span class="sig-name descname"><span class="pre">do_weighted_binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mbin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantity</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytreegrav.treewalk.do_weighted_binning" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pytreegrav">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pytreegrav" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Mike Grudic.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>